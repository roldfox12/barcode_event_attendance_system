{% extends 'base.html' %}
{% block content %}
<h2>All Events</h2>

<!-- Search Form -->
<form method="get" action="" style="margin-bottom: 20px; display: flex; gap: 8px; align-items: center;">
    <input type="text" name="q" placeholder="Search event name..." value="{{ request.GET.q|default_if_none:'' }}" style="padding:8px; border-radius:6px; border:1px solid #e6007a; width: 250px;">
    <button type="submit" style="background:#e6007a; color:#fff; border:none; padding:8px 18px; border-radius:6px; cursor:pointer;">Search</button>
    {% if request.GET.q %}
        <a href="{% url 'events_list' %}" style="margin-left:8px; color:#e6007a; text-decoration:underline;">Clear</a>
    {% endif %}
</form>

<table style="width:100%; border-collapse:collapse; background:#fff;">
    <thead>
        <tr style="background:#ffe3f0;">
            <th style="padding:8px; border:1px solid #e6007a;">Event Name</th>
            <th style="padding:8px; border:1px solid #e6007a;">Date</th>
            <th style="padding:8px; border:1px solid #e6007a;">Action</th>
        </tr>
    </thead>
    <tbody>
        {% for event in events %}
        <tr>
            <td style="padding:8px; border:1px solid #e6007a;">{{ event.name }}</td>
            <td style="padding:8px; border:1px solid #e6007a;">{{ event.date|date:"M j, Y h:i A" }}</td>
            <td style="padding:8px; border:1px solid #e6007a; vertical-align: middle;">
                <div style="display: flex; gap: 10px; align-items: center;">
                    <a href="{% url 'edit_event' event.id %}" style="display: flex; align-items: center;">
                        <button type="button" style="background:#fff; color:#e6007a; border:2px solid #e6007a; padding:6px 14px; border-radius:4px; cursor:pointer;">Edit</button>
                    </a>
                    <form method="post" action="{% url 'delete_event' event.id %}" style="display:inline; margin:0;">
                        {% csrf_token %}                        
                        <button type="submit" style="background:#fff; color:#e6007a; border:2px solid #e6007a; padding:6px 14px; border-radius:4px; cursor:pointer;"
                            onclick="return confirm('Are you sure you want to delete this event?');">
                            Delete
                        </button>
                    </form>
                </div>
            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="3" style="padding:8px; border:1px solid #e6007a;">No events found.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
<a href="{% url 'dashboard' %}">
    <button type="button" style="background:#e6007a; color:#fff; border:2px solid #e6007a; padding:8px 18px; border-radius:6px; cursor:pointer; margin-top:20px;">
        Back to Dashboard
    </button>
</a>
{% endblock %}